<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>merge_dbs() — merge_dbs • OTrecod</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="merge_dbs() — merge_dbs" />
<meta property="og:description" content="Harmonization and merging before data fusion of two databases with specific outcome variables and shared covariates." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">OTrecod</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>merge_dbs()</h1>
    
    <div class="hidden name"><code>merge_dbs.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Harmonization and merging before data fusion of two databases with specific outcome variables and shared covariates.</p>
    </div>

    <pre class="usage"><span class='fu'>merge_dbs</span><span class='op'>(</span>
  <span class='va'>DB1</span>,
  <span class='va'>DB2</span>,
  row_ID1 <span class='op'>=</span> <span class='cn'>NULL</span>,
  row_ID2 <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>NAME_Y</span>,
  <span class='va'>NAME_Z</span>,
  order_levels_Y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='va'>DB1</span><span class='op'>[</span>, <span class='va'>NAME_Y</span><span class='op'>]</span><span class='op'>)</span>,
  order_levels_Z <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='va'>DB2</span><span class='op'>[</span>, <span class='va'>NAME_Z</span><span class='op'>]</span><span class='op'>)</span>,
  ordinal_DB1 <span class='op'>=</span> <span class='cn'>NULL</span>,
  ordinal_DB2 <span class='op'>=</span> <span class='cn'>NULL</span>,
  impute <span class='op'>=</span> <span class='st'>"NO"</span>,
  R_MICE <span class='op'>=</span> <span class='fl'>5</span>,
  NCP_FAMD <span class='op'>=</span> <span class='fl'>3</span>,
  seed_func <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>1e+06</span>, <span class='fl'>1</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>DB1</th>
      <td><p>a data.frame corresponding to the 1st database to merge (top database)</p></td>
    </tr>
    <tr>
      <th>DB2</th>
      <td><p>a data.frame corresponding to the 2nd database to merge (bottom database)</p></td>
    </tr>
    <tr>
      <th>row_ID1</th>
      <td><p>the column index of the row identifier of DB1 if it exists (no identifier by default)</p></td>
    </tr>
    <tr>
      <th>row_ID2</th>
      <td><p>the column index of the row identifier of DB2 if it exists (no identifier by default)</p></td>
    </tr>
    <tr>
      <th>NAME_Y</th>
      <td><p>the name of the outcome (with quotes) in its specific scale/encoding from the 1st database (DB1)</p></td>
    </tr>
    <tr>
      <th>NAME_Z</th>
      <td><p>the name of the outcome (with quotes) in its specific scale/encoding from the 2nd database (DB2)</p></td>
    </tr>
    <tr>
      <th>order_levels_Y</th>
      <td><p>the levels of \(Y\) stored in a vector and sorted in ascending order in the case of ordered factors. This option permits to reorder the levels in the 1st database (DB1) if necessary.</p></td>
    </tr>
    <tr>
      <th>order_levels_Z</th>
      <td><p>the levels of \(Z\) stored in a vector and sorted in ascending order in the case of ordered factors. This option permits to reorder the levels in the 2nd database (DB2) if necessary.</p></td>
    </tr>
    <tr>
      <th>ordinal_DB1</th>
      <td><p>a vector of column indexes corresponding to ordinal variables in the 1st database (no ordinal variable by default)</p></td>
    </tr>
    <tr>
      <th>ordinal_DB2</th>
      <td><p>a vector of column indexes corresponding to ordinal variables in the 2nd database (no ordinal variable by default)</p></td>
    </tr>
    <tr>
      <th>impute</th>
      <td><p>a character equals to "NO" when missing data on covariates are kept (Default option), "CC" for Complete Case by keeping only covariates with no missing information , "MICE" for MICE multiple imputation approach, "FAMD" for single imputation approach using Factorial Analysis for Mixed Data</p></td>
    </tr>
    <tr>
      <th>R_MICE</th>
      <td><p>the chosen number of multiple imputations required for the  MICE approach (5 by default)</p></td>
    </tr>
    <tr>
      <th>NCP_FAMD</th>
      <td><p>an integer corresponding to the number of components used to predict missing values in FAMD imputation (3 by default)</p></td>
    </tr>
    <tr>
      <th>seed_func</th>
      <td><p>an integer used as argument by the set.seed() for offsetting the random number generator (Random integer by default, only useful with MICE)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list containing 12 elements (13 when <code>impute</code> equals "MICE"):</p>
<dt>DB_READY</dt><dd><p>the database matched from the two initial databases with common covariates and imputed or not according to the impute option</p></dd>
<dt>ID1</dt><dd><p>the row identifier of DB1 after merging when it exists</p></dd>
<dt>ID2</dt><dd><p>the row identifier of DB2 after merging when it exists</p></dd>
<dt>Y_LEVELS</dt><dd><p>the remaining levels of the target variable \(Y\) in the DB1</p></dd>
<dt>Z_LEVELS</dt><dd><p>the remaining Levels of the target variable \(Z\) in the DB2</p></dd>
<dt>REMOVE1</dt><dd><p>the labels of the deleted covariates because of type incompatibilies of type from DB1 to DB2</p></dd>
<dt>REMOVE2</dt><dd><p>the removed factor(s) because of levels incompatibilities from DB1 to DB2</p></dd>
<dt>REMAINING_VAR</dt><dd><p>labels of the remained covariates for data fusion</p></dd>
<dt>IMPUTE_TYPE</dt><dd><p>a character with quotes that specify the method eventually chosen to handle missing data in covariates</p></dd>
<dt>MICE_DETAILS</dt><dd><p>a list containing the details of the imputed datasets using <code>MICE</code> when this option is enabled. Databases imputed for DB1 and DB2 according to the number of mutliple imputation selected (Only if impute = "MICE")</p></dd>
<dt>DB1_raw</dt><dd><p>a data.frame corresponding to the row identifier of DB1 after merging</p></dd>
<dt>DB2_raw</dt><dd><p>a data.frame corresponding to the row identifier of DB2 after merging</p></dd>
<dt>SEED</dt><dd><p>an integer used as argument by the <code>set.seed</code> function for offsetting the random number generator (random selection by default)</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Assuming that DB1 and DB2 are two databases (two separate data.frames with no overlapping rows) to be merged vertically before data fusion, the function <code>merge_dbs</code> performs this merging and checks the harmonization of the shared variables.
Firslty, the two databases declared as input to the function (via the argument <code>DB1</code> and <code>DB2</code>) must have the same specific structure.
Each database must contain a target variable (whose label must be filled in the argument <code>Y</code> for DB1 and in <code>Z</code> for DB2 respectively, so that the final synthetic database in output will contain an incomplete variable <code>Y</code> whose corresponding values will be missing in DB2 and another incomplete target <code>Z</code> whose values will be missing in DB1), a subset of shared covariates (by example, the best predictors of \(Y\) in DB1, and \(Z\) in DB2).
Each database can have a row identifier whose label must be assigned in the argument <code>row_ID1</code> for DB1 and <code>row_ID2</code> for DB2. Nevertheless, by default DB1 and DB2 are supposed with no row identifiers. The merging keeps unchanged the order of rows in the two databases provided that \(Y\) and \(Z\) have no missing values.
By building, the first declared database (in the argument <code>DB1</code>) will be placed automatically above the second one (declared in the argument <code>DB2</code>) in the final database.</p>
<p>Firstly, by default, a variable with the same name in the two databases is abusively considered as shared. This condition is obviously insufficient to be kept in the final subset of shared variables,
and the function <code>merge_dbs</code> so performs checks before merging described below.</p>
<p>A. Discrepancies between shared variables</p><ul>
<li><p>Shared variables with discrepancies of types between the two databases (for example, a variable with a common name in the two databases but stored as numeric in DB1, and stored as character in DB2) will be removed from the merging and the variable name will be saved in output (<code>REMOVE1</code>).</p></li>
<li><p>Shared factors with discrepancies of levels (or number of levels) will be also removed from the merging and the variable name will be saved in output (<code>REMOVE2</code>).</p></li>
<li><p>covariates whose names are specific to each database will be also deleted from the merging.</p></li>
<li><p>If some important predictors have been improperly excluded from the merging due to the above-mentioned checks, it is possible for user to transform these variables a posteriori, and re-run the function.</p></li>
</ul>

<p>B. Rules for the two outcomes (target variables)</p>
<p>The types of <code>Y</code> and <code>Z</code> must be suitable:</p><ul>
<li><p>Categorical (ordered or not) factors are allowed.</p></li>
<li><p>Numeric and discrete outcomes with a finite number of values are allowed but will be automatically converted as ordered factors using the function <code>transfo_target</code> integrated in the function <code>merge_dbs</code>.</p></li>
</ul>

<p>C. The function <code>merge_dbs</code> handles incomplete information of shared variables, by respecting the following rules:</p><ul>
<li><p>If <code>Y</code> or <code>Z</code> have missing values in DB1 or DB2, corresponding rows are excluded from the database before merging. Moreover, in the case of incomplete outcomes,
if A and B have row identifiers, the corresponding identifiers are removed and these latters are stored in the objects <code>DB1_ID</code> and <code>DB2_ID</code> of the output.</p></li>
<li><p>Before overlay, the function deals with incomplete covariates according to the argument <code>impute</code>.
Users can decide to work with complete case only ("CC"), to keep ("NO") or impute incomplete information ("MICE","FAMD").</p></li>
<li><p>The function <code>imput_cov</code>, integrated in the syntax of <code>merge_dbs</code> deals with imputations. Two approaches are actually available:
the multivariate imputation by chained equation approach (MICE, see (3) for more details about the approach or the corresponding package <span class="pkg">mice</span>),
and an imputation approach from the package <span class="pkg">missMDA</span> that uses a dimensionality reduction method (here a factor analysis for mixed data called FAMD (4)), to provide single imputations.
If multiple imputation is required (<code>impute</code> = "MICE"), the default imputation methods are applied according to the type of the variables. The average of the plausible values will be kept for a continuous variable, while the most frequent candidate will be kept as a consensus value for a categorical variable or factor (ordinal or not).</p></li>
</ul>

<p>As a finally step, the function checks that all values related to \(Y\) in B are missing and inversely for \(Z\) in A.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
<ol>
<li><p>Gares V, Dimeglio C, Guernec G, Fantin F, Lepage B, Korosok MR, savy N. (2019). On the use of optimal transportation theory to recode variables and application to database merging. The International Journal of Biostatistics. 0, 20180106 (2019),<a href='https://doi.org/10.1515/ijb-2018-0106'>https://doi.org/10.1515/ijb-2018-0106</a></p></li>
<li><p>Gares V, Omer J. (2020) Regularized optimal transport of covariates and outcomes in data recoding. Journal of the American Statistical Association, DOI: 10.1080/01621459.2020.1775615</p></li>
<li><p>van Buuren, S., Groothuis-Oudshoorn, K. (2011). mice: Multivariate Imputation by Chained Equations in R. Journal of Statistical Software, 45(3), 1–67. urlhttps://www.jstatsoft.org/v45/i03/</p></li>
<li><p>Josse J, Husson F. (2016). missMDA: A Package for Handling Missing Values in Multivariate Data Analysis. Journal of Statistical Software, 70(1), 1–31. DOI: 10.18637/jss.v070.i01</p></li>
</ol>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='imput_cov.html'>imput_cov</a></code>, <code><a href='transfo_target.html'>transfo_target</a></code>, <code><a href='select_pred.html'>select_pred</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Gregory Guernec</p>
<p><a href='mailto:otrecod.pkg@gmail.com'>otrecod.pkg@gmail.com</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>### Assuming two distinct databases from simu_data: data_A and data_B</span>
<span class='co'>### Some transformations will be made beforehand on variables to generate</span>
<span class='co'>### heterogeneities between the two bases.</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>simu_data</span><span class='op'>)</span>
<span class='va'>data_A</span> <span class='op'>=</span> <span class='va'>simu_data</span><span class='op'>[</span><span class='va'>simu_data</span><span class='op'>$</span><span class='va'>DB</span> <span class='op'>==</span> <span class='st'>"A"</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>4</span><span class='op'>:</span><span class='fl'>8</span><span class='op'>)</span><span class='op'>]</span>; <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>data_A</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       Yb1 Gender Treatment Dosage Smoking      Age
#&gt; 1 [40-60[ Female     Trt A  Dos 3     YES 65.44273
#&gt; 2 [20-40]   Male      &lt;NA&gt;  Dos 2      NO 51.78596
#&gt; 3 [40-60[ Female   Placebo  Dos 2     YES 49.10844
#&gt; 4 [40-60[ Female     Trt B  Dos 4    &lt;NA&gt; 56.43524
#&gt; 5 [40-60[ Female     Trt A  Dos 4     YES 44.77365
#&gt; 6 [20-40] Female     Trt A  Dos 1    &lt;NA&gt;       NA</div><div class='input'><span class='va'>data_B</span> <span class='op'>=</span> <span class='va'>simu_data</span><span class='op'>[</span><span class='va'>simu_data</span><span class='op'>$</span><span class='va'>DB</span> <span class='op'>==</span> <span class='st'>"B"</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>3</span>,<span class='fl'>4</span><span class='op'>:</span><span class='fl'>8</span><span class='op'>)</span><span class='op'>]</span>; <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>data_B</span><span class='op'>)</span>
</div><div class='output co'>#&gt;     Yb2 Gender Treatment Dosage Smoking      Age
#&gt; 301   5 Female   Placebo  Dos 2     YES 44.58233
#&gt; 302   1 Female     Trt B  Dos 4    &lt;NA&gt; 65.23921
#&gt; 303   2 Female   Placebo   &lt;NA&gt;      NO 51.64228
#&gt; 304   2 Female     Trt A   &lt;NA&gt;      NO 50.15125
#&gt; 305   1 Female     Trt B  Dos 4     YES 61.53242
#&gt; 306   1 Female     Trt B  Dos 3    &lt;NA&gt; 60.54819</div><div class='input'>
<span class='co'># For the example, a covariate is added (Weight) only in data_A</span>
<span class='va'>data_A</span><span class='op'>$</span><span class='va'>Weight</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>300</span>,<span class='fl'>70</span>,<span class='fl'>5</span><span class='op'>)</span>

<span class='co'># Be careful: the target variables must be in factor (or ordered) in the 2 databases</span>
<span class='co'># Because it is not the case for Yb2 in data_B, the function will convert it.</span>
<span class='va'>data_B</span><span class='op'>$</span><span class='va'>Yb2</span>    <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>data_B</span><span class='op'>$</span><span class='va'>Yb2</span><span class='op'>)</span>

<span class='co'># Moreover, the Dosage covariate is stored in 3 classes in data_B (instead of 4 classes in data_B)</span>
<span class='co'># to make the encoding of this covariate specific to each database.</span>
<span class='va'>data_B</span><span class='op'>$</span><span class='va'>Dosage</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>data_B</span><span class='op'>$</span><span class='va'>Dosage</span><span class='op'>)</span>
<span class='va'>data_B</span><span class='op'>$</span><span class='va'>Dosage</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>data_B</span><span class='op'>$</span><span class='va'>Dosage</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Dos 1"</span>,<span class='st'>"Dos 2"</span><span class='op'>)</span>,<span class='st'>"D1"</span>,
                          <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>data_B</span><span class='op'>$</span><span class='va'>Dosage</span> <span class='op'>==</span> <span class='st'>"Dos 3"</span>,<span class='st'>"D3"</span>,<span class='st'>"D4"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># For more diversity, this covariate iis placed at the last column of the data_B</span>
<span class='va'>data_B</span>        <span class='op'>=</span> <span class='va'>data_B</span><span class='op'>[</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span>,<span class='fl'>5</span>,<span class='fl'>6</span>,<span class='fl'>4</span><span class='op'>)</span><span class='op'>]</span>

<span class='co'># Ex 1: The two databases are merged and incomplete covariates are imputed using MICE</span>
<span class='va'>soluc1</span>  <span class='op'>=</span> <span class='fu'>merge_dbs</span><span class='op'>(</span><span class='va'>data_A</span>,<span class='va'>data_B</span>,
                    NAME_Y <span class='op'>=</span> <span class='st'>"Yb1"</span>,NAME_Z <span class='op'>=</span> <span class='st'>"Yb2"</span>,
                    ordinal_DB1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>4</span><span class='op'>)</span>, ordinal_DB2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>6</span><span class='op'>)</span>,
                    impute <span class='op'>=</span> <span class='st'>"MICE"</span>,R_MICE <span class='op'>=</span> <span class='fl'>2</span>, seed_func <span class='op'>=</span> <span class='fl'>3011</span><span class='op'>)</span>
</div><div class='output co'>#&gt; DBS MERGING in progress. Please wait ... 
#&gt; Y 
#&gt; Z 
#&gt; DBS MERGING OK 
#&gt; -----------------------
#&gt; SUMMARY OF DBS MERGING: 
#&gt; Nb of removed subjects because of NA on targets: 0 ( 0 %) 
#&gt; Nb of covariates removed because of differences between the 2 bases: 1 
#&gt; Nb of covariates remained: 4 
#&gt; Imputation on incomplete covariates: MICE </div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>soluc1</span><span class='op'>$</span><span class='va'>DB_READY</span><span class='op'>)</span>
</div><div class='output co'>#&gt;        DB              Y          Z            Age           Gender   
#&gt;  Min.   :1.000   [20-40]:130   1   :145   Min.   :34.37   Female:414  
#&gt;  1st Qu.:1.000   [40-60[:127   2   : 51   1st Qu.:46.83   Male  :286  
#&gt;  Median :2.000   [60-80]: 43   3   : 35   Median :50.12               
#&gt;  Mean   :1.571   NA's   :400   4   : 43   Mean   :50.12               
#&gt;  3rd Qu.:2.000                 5   :126   3rd Qu.:53.51               
#&gt;  Max.   :2.000                 NA's:300   Max.   :65.44               
#&gt;  Smoking     Treatment  
#&gt;  NO :374   Placebo:358  
#&gt;  YES:326   Trt A  :209  
#&gt;            Trt B  :133  
#&gt;                         
#&gt;                         
#&gt;                         </div><div class='input'>

<span class='co'># Ex 2: The two databases are merged and missing values are kept</span>
<span class='va'>soluc2</span>  <span class='op'>=</span> <span class='fu'>merge_dbs</span><span class='op'>(</span><span class='va'>data_A</span>,<span class='va'>data_B</span>,
                    NAME_Y <span class='op'>=</span> <span class='st'>"Yb1"</span>,NAME_Z <span class='op'>=</span> <span class='st'>"Yb2"</span>,
                    ordinal_DB1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>4</span><span class='op'>)</span>, ordinal_DB2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>6</span><span class='op'>)</span>,
                    impute <span class='op'>=</span> <span class='st'>"NO"</span>,seed_func <span class='op'>=</span> <span class='fl'>3011</span><span class='op'>)</span>
</div><div class='output co'>#&gt; DBS MERGING in progress. Please wait ... 
#&gt; Y 
#&gt; Z 
#&gt; DBS MERGING OK 
#&gt; -----------------------
#&gt; SUMMARY OF DBS MERGING: 
#&gt; Nb of removed subjects because of NA on targets: 0 ( 0 %) 
#&gt; Nb of covariates removed because of differences between the 2 bases: 1 
#&gt; Nb of covariates remained: 4 
#&gt; Imputation on incomplete covariates: NO </div><div class='input'>
<span class='co'># Ex 3: The two databases are merged by only keeping the complete cases</span>
<span class='va'>soluc3</span>  <span class='op'>=</span> <span class='fu'>merge_dbs</span><span class='op'>(</span><span class='va'>data_A</span>,<span class='va'>data_B</span>,
                    NAME_Y <span class='op'>=</span> <span class='st'>"Yb1"</span>,NAME_Z <span class='op'>=</span> <span class='st'>"Yb2"</span>,
                    ordinal_DB1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>4</span><span class='op'>)</span>, ordinal_DB2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>6</span><span class='op'>)</span>,
                    impute <span class='op'>=</span> <span class='st'>"CC"</span>,seed_func <span class='op'>=</span> <span class='fl'>3011</span><span class='op'>)</span>
</div><div class='output co'>#&gt; DBS MERGING in progress. Please wait ... 
#&gt; Y 
#&gt; Z 
#&gt; DBS MERGING OK 
#&gt; -----------------------
#&gt; SUMMARY OF DBS MERGING: 
#&gt; Nb of removed subjects because of NA on targets: 0 ( 0 %) 
#&gt; Nb of covariates removed because of differences between the 2 bases: 1 
#&gt; Nb of covariates remained: 4 
#&gt; Imputation on incomplete covariates: CC </div><div class='input'>
<span class='co'># Ex 4: The two databases are merged and incomplete covariates are imputed using FAMD</span>
<span class='va'>soluc4</span>  <span class='op'>=</span> <span class='fu'>merge_dbs</span><span class='op'>(</span><span class='va'>data_A</span>,<span class='va'>data_B</span>,
                    NAME_Y <span class='op'>=</span> <span class='st'>"Yb1"</span>,NAME_Z <span class='op'>=</span> <span class='st'>"Yb2"</span>,
                    ordinal_DB1 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>4</span><span class='op'>)</span>, ordinal_DB2 <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>6</span><span class='op'>)</span>,
                    impute <span class='op'>=</span> <span class='st'>"FAMD"</span>,NCP_FAMD <span class='op'>=</span> <span class='fl'>4</span>,seed_func <span class='op'>=</span> <span class='fl'>2096</span><span class='op'>)</span>
</div><div class='output co'>#&gt; DBS MERGING in progress. Please wait ... 
#&gt; Y 
#&gt; Z 
#&gt; DBS MERGING OK 
#&gt; -----------------------
#&gt; SUMMARY OF DBS MERGING: 
#&gt; Nb of removed subjects because of NA on targets: 0 ( 0 %) 
#&gt; Nb of covariates removed because of differences between the 2 bases: 1 
#&gt; Nb of covariates remained: 4 
#&gt; Imputation on incomplete covariates: FAMD </div><div class='input'>
<span class='co'># Conclusion:</span>
<span class='co'># The data fusion is successful in each situation.</span>
<span class='co'># The Dosage and Weight covariates have been normally excluded from the fusion.</span>
<span class='co'># The covariates have been imputed when required.</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Gregory Guernec, Valerie Gares.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


