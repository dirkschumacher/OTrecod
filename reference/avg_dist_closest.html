<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>avg_dist_closest() — avg_dist_closest • OTrecod</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="avg_dist_closest() — avg_dist_closest" />
<meta property="og:description" content="This function computes average distances between levels of two categorical outcomes located in two distinct databases" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">OTrecod</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>avg_dist_closest()</h1>
    
    <div class="hidden name"><code>avg_dist_closest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function computes average distances between levels of two categorical outcomes located in two distinct databases</p>
    </div>

    <pre class="usage"><span class='fu'>avg_dist_closest</span>(<span class='kw'>proxim</span>, percent_closest = <span class='fl'>1</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>proxim</th>
      <td><p>An object corresponding to the output of the <code>proxim_dist</code> function</p></td>
    </tr>
    <tr>
      <th>percent_closest</th>
      <td><p>A value between 0 and 1 corresponding to the desired percent of rows (or individuals) that will be taken into acccount for the computation of the average distances between levels of factors or
between individuals and levels of only one factor (the value 1 is taken by default, therefore, all individuals with a same level of \(Y\) or a same level of \(Z\) will be remained for the average computations).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of 3 matrices is returned:</p>
<dt>Davg</dt><dd><p>The cost matrix whose number of rows corresponds to \(n_Y\), the number of levels of the target variable \(Y\) in the database A, and whose number of columns corresponds to \(n_Z\): the number of levels of the target variable in B.
In this case, the related cost matrix can be interpreted as the ability to move from one level of \(Y\) in A to one level of \(Z\) in B.
Davg[P,Q] refers to the average distance between the modality P of \(Y\) (only known in A) and modality \(Q\) of \(Z\) (only known in B).</p></dd>
<dt>DindivA</dt><dd><p>A matrix whose number of rows corresponds to the number of rows of the first database A and number of columns corresponds to \(n_Z\), the number of levels of the target variable \(Z\) in the second database B.
DindivA[i,Q] refers to the average distance between the \(i^{th}\) individual (or row) of the first database and a chosen proportion of individuals (<code>percent_closest</code> set by the user) of the second database having the modality \(Q\) of \(Z\).</p></dd>
<dt>DindivB</dt><dd><p>A matrix whose number of rows corresponds to the number of rows of the second database B and number of columns corresponds to nA, the number of levels of the target variable in the first database A.
DindivB[k,P] refers to the average distance between the \(k^{th}\) individual (or row) of the second database and a chosen proportion of individuals (depending on <code>percent_closest</code>) of the first database having the modality P of \(Y\).</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function <code>avg_dist_closest</code> is an intermediate function for the implementation of original algorithms dedicated to the solving of recoding problems in data fusion using Optimal Transportation theory (for more details, consult the corresponding algorithms called
<code>OUTCOME</code>, <code>R_OUTCOME</code>, <code>JOINT</code> and <code>R_JOINT</code>, in the reference (2)). The function <code>avg_dist_closest</code> is so directly implemented in the <code>OT_outcome</code> and <code>OT_joint</code> functions but can also be used separately.
The function <code>avg_dist_closest</code> uses, in particular, the D distance matrix (that stores distances between rows of A and B) from the function <code>proxim_dist</code> to produce three distinct matrices saved in a list object.
Therefore, the function requires in input, the specific output of the function <code>proxim_dist</code> which is available in the package and so must be used beforehand.
In consequence, do not use this function directly on your database, and do not hesitate to consult the provided examples provided for a better understanding.</p>

<p>DEFINITION OF THE COST MATRIX</p>
<p>Assuming that A and B are two databases with a set of shared variables and that a same information (referred to a same target population) is stored as a variable \(Y\) in A and \(Z\) in B, such that \(Y\) is unknown in B and \(Z\) is unknown in A, whose encoding depends on the database (\(n_Y\) levels in A and \(n_Z\) levels in B).
A distance between one given level y of \(Y\) and one given level z of Z is estimated by averaging the distances between the two subsets of individuals (units or rows) assigned to y in A and z in B, characterized by their vectors of covariates.
The distance between two individuals depends on the variations between the shared covariates, and so depends on the chosen distance function using the function <code>proxim_dist</code>.
For these computations, all the individuals concerned by these two levels can be taken into account, or only a part of them, depending on the argument <code>percent_closest</code>.
When <code>percent_closest</code> &lt; 1, the average distance between an individual i and a given level of factor z only uses the corresponding part of individuals related to z that are the closest to i.
Therefore, this choice influences the estimations of average distances between levels of factors but also permits to reduce time computation when necessary.</p>
<p>The average distance between each individual of \(Y\) (\(Z\)) and each levels of \(Z\) (\(Y\)) are returned in output, in the object <code>DindivA</code> (<code>DindivB</code> respectively).
The average distance between each levels of \(Y\) and each levels of \(Z\) are returned in a matrix saved in output (the object <code>Davg</code>).
<code>Davg</code> returns the computation of the cost matrix D, whose dimensions (\(n_Y \times n_Z\)) correspond to the number of levels of \(Y\) (rows) and \(Z\) (columns).
This matrix can be seen as the ability for an individual (row) to move from a given level of the target variable (\(Y\)) in A to a given level of \(Z\) in the database B (or vice versa).</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
<ol>
<li><p>Gares V, Dimeglio C, Guernec G, Fantin F, Lepage B, Korosok MR, savy N (2019). On the use of optimal transportation theory to recode variables and application to database merging. The International Journal of Biostatistics.
Volume 16, Issue 1, 20180106, eISSN 1557-4679 | <a href='https://doi.org/10.1515/ijb-2018-0106'>https://doi.org/10.1515/ijb-2018-0106</a></p></li>
<li><p>Gares V, Omer J (2020) Regularized optimal transport of covariates and outcomes in data recoding. Journal of the American Statistical Association, DOI: 10.1080/01621459.2020.1775615</p></li>
</ol>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code>proxim_dist</code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Gregory Guernec, Valerie Gares, Jeremy Omer</p>
<p><a href='mailto:otrecod.pkg@gmail.com'>otrecod.pkg@gmail.com</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='kw'>simu_data</span>)
<span class='co'>### The covariates of the data are prepared according to the distance chosen</span>
<span class='co'>### using the transfo_dist function</span>

<span class='co'>### Example with The Manhattan distance</span>

<span class='kw'>try1</span> <span class='op'>=</span> <span class='fu'>transfo_dist</span>(<span class='kw'>simu_data</span>,quanti = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>3</span>,<span class='fl'>8</span>), nominal = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>,<span class='fl'>4</span><span class='op'>:</span><span class='fl'>5</span>,<span class='fl'>7</span>),
                    ordinal = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>,<span class='fl'>6</span>), logic = <span class='kw'>NULL</span>, prep_choice = <span class='st'>"M"</span>)</div><div class='output co'>#&gt; Your target DB[, "Z"] was numeric ... By default, it has been converted in factor of integers 
#&gt; 5 remaining levels </div><div class='input'><span class='kw'>res1</span> <span class='op'>=</span> <span class='fu'>proxim_dist</span>(<span class='kw'>try1</span>,norm = <span class='st'>"M"</span>)

<span class='co'># proxim_dist() fixes the chosen distance function,</span>
<span class='co'># and defines neighborhoods between profiles and individuals</span>

<span class='co'># The following row uses only 80 percents of individuals of each level</span>
<span class='co'># of factors for the computation of the average distances:</span>

<span class='kw'>res_new</span>  <span class='op'>=</span> <span class='fu'>avg_dist_closest</span>(<span class='kw'>res1</span>,percent_closest = <span class='fl'>0.80</span>)

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Gregory Guernec, Valerie Gares.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


